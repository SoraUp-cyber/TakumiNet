<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../src/footer.css">
  <link rel="stylesheet" href="../src/index.css">
  <link rel="stylesheet" href="../src/nav.css">
  <link rel="stylesheet" href="../src/comunidad.css">
  <title>Comunidad de Desarrolladores</title>
  <style>

.forum-section {
  background-color: #2d2d2d;
  color: #ffffff;
  padding: 20px;
  border-radius: 8px;
  margin: 20px auto;
  width: 98%;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.topic-image-container {
  width: 240px;   /* Más ancha */
  height: 140px;  /* Proporcional altura */
  border-radius: 8px;
  overflow: hidden;
  margin-right: 15px;
  border: 2px solid #4CAF50;
}

.topic-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s;
}



.topic-card:hover .topic-image {
  transform: scale(1.05); /* Efecto zoom al pasar el mouse */
}

/* Ajustamos el layout del header para mejor visualización */
.topic-header {
  display: flex;
  padding: 15px;
  align-items: center;
  border-bottom: 1px solid #4CAF50;
  min-height: 130px; /* Altura mínima para consistencia */
}

/* Resto del CSS se mantiene igual */
.topic-info {
  flex: 1;
}

.topic-info h3 {
  margin: 0;
  font-size: 18px;
}

.topic-info h3 a {
  color: white;
  text-decoration: none;
}

.topic-info h3 a:hover {
  color: #4CAF50;
}

.topic-meta {
  font-size: 12px;
  color: #cccccc;
  margin-top: 5px;
}

.topic-content {
  padding: 15px;
  flex: 1;
}

.topic-content p {
  margin: 0 0 10px 0;
  line-height: 1.5;
}

.topic-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  margin-top: 10px;
}

.tag {
  background-color: #4CAF50;
  color: white;
  padding: 3px 8px;
  border-radius: 12px;
  font-size: 12px;
}

.topic-footer {
  padding: 10px 15px;
  background-color: #333333;
  text-align: right;
}

.btn-view-topic {
  background-color: #4CAF50;
  color: white;
  border: none;
  padding: 8px 15px;
  border-radius: 4px;
  cursor: pointer;
  font-weight: bold;
  transition: background-color 0.3s;
}

.btn-view-topic:hover {
  background-color: #45a049;
}

/* Responsive: ajustamos para móviles */
@media (max-width: 768px) {
  .topic-header {
    flex-direction: column;
    text-align: center;
    min-height: auto;
  }
  
  .topic-image-container {
    margin-right: 0;
    margin-bottom: 15px;
    width: 80px;
    height: 80px;
  }
}



.promo-btn {
  display: inline-block;
  background-color: #28a745; /* Verde vibrante */
  color: #fff;
  padding: 10px 20px;       /* Tamaño mediano */
  border-radius: 6px;
  font-weight: 600;
  font-size: 0.9rem;        /* Tamaño de fuente mediano */
  text-decoration: none;
  box-shadow: 0 3px 6px rgba(40, 167, 69, 0.4);
  transition: background-color 0.25s ease, box-shadow 0.25s ease;
  user-select: none;
  cursor: pointer;
  margin: 12px 0 24px 0;    /* Baja el botón con margen superior de 12px */
}

.promo-btn:hover,
.promo-btn:focus {
  background-color: #218838; /* Verde más oscuro */
  box-shadow: 0 5px 10px rgba(33, 136, 56, 0.6);
  outline: none;
}





 
  </style>
</head>
<body>
 <nav class="navbar">
    <!-- Sección Izquierda: Logo -->
    <div class="navbar-logo">
        <img src="../assets/img/logo.png" alt="Logo de TakumiNet">
    </div>

    <!-- Sección Central: Enlaces de navegación -->
    <ul class="nav-links">
      <li><a href="index.html" class="active" aria-current="page"><i class="fas fa-home"></i> <span data-i18n="inicio">Inicio</span></a></li>
      <li><a href="marketplace.html"><i class="fas fa-store"></i> <span data-i18n="tienda">Tienda</span></a></li>
      <li><a href="game jam.html"><i class="fas fa-calendar-alt"></i> <span data-i18n="game_jams">Game Jams</span></a></li>
      <li><a href="centro-aprendiz.html"><i class="fas fa-graduation-cap"></i> <span data-i18n="tutoriales">Tutoriales</span></a></li>
      <li><a href="ranking.html"><i class="fas fa-newspaper"></i> <span data-i18n="Noticias">Noticias</span></a></li>
      <li><a href="comunidad.html"><i class="fas fa-users"></i> <span data-i18n="comunidad">Comunidad</span></a></li>
    </ul>

    <!-- Sección Derecha: Elementos interactivos -->
    <div class="nav-right">
      <!-- Búsqueda -->
      <form class="search-box" role="search">
        <input type="search" class="search-input" placeholder="Buscar juegos, usuarios..." aria-label="Buscar en el sitio" data-i18n="buscar" data-i18n-type="placeholder">
        <button type="submit" class="search-btn" aria-label="Ejecutar búsqueda">
          <i class="fas fa-search"></i>
        </button>
      </form>

      <!-- Iconos de notificaciones -->
      <div class="nav-icons">
        <div class="notification-wrapper">
          <button class="icon-btn notification-btn" onclick="toggleNotifications()" aria-haspopup="true" aria-expanded="false" aria-label="Notificaciones">
            <i class="fas fa-bell"></i>
            <span class="notification-badge" id="notificationBadge" aria-live="polite">0</span>
          </button>

          <!-- Menú desplegable de notificaciones -->
          <div class="dropdown-menu notification-dropdown" id="notificationDropdown" role="menu" aria-hidden="true" style="display:none;">
            <div class="dropdown-header">
              <h4 class="dropdown-title" data-i18n="notificaciones">Notificaciones</h4>
              <button class="mark-read" id="markReadBtn" data-i18n="ver_todas">Marcar todas como leídas</button>
            </div>

            <div class="notifications-list" id="notificationsList">
              <!-- Aquí se insertarán las notificaciones dinámicamente -->
            </div>
            <div class="dropdown-footer">
              <a href="/notificaciones" class="view-all" data-i18n="ver_todas">Ver todas</a>
            </div>
          </div>
        </div>

        <!-- Carrito de compras -->
        <div class="icon-btn cart-btn" aria-label="Carrito de compras" role="button" tabindex="0" onclick="toggleCart()">
          <i class="fas fa-shopping-cart"></i>
          <span class="cart-badge" aria-live="polite">5</span>
        </div>

        <!-- Menú de usuario -->
        <div class="user-menu">
          <button class="user-profile" aria-haspopup="true" aria-expanded="false" onclick="toggleUserMenu()">
            <div class="avatar">
              <i class="fas fa-user"></i>
            </div>
            <span class="username" id="mostrarNombre">Invitado</span>
          </button>

          <!-- Menú desplegable de usuario -->
          <div class="user-dropdown" id="userDropdown" role="menu" aria-hidden="true">
            <div class="dropdown-group">
              <a href="perfil del usuario.html" class="menu-item"><i class="fas fa-user"></i><span data-i18n="perfil">Perfil</span></a>
              <a href="mis juegos.html" class="menu-item"><i class="fas fa-gamepad"></i><span data-i18n="mis_juegos">Mis Juegos</span></a>
              <a href="juegos favoritos.html" class="menu-item"><i class="fas fa-heart"></i><span data-i18n="favoritos">Favoritos</span></a>
              <a href="Creator Dashboard.html" class="menu-item"><i class="fas fa-tachometer-alt"></i><span data-i18n="dashboard">Dashboard</span></a>
              <a href="subir_juegos.html" class="menu-item"><i class="fas fa-upload"></i><span data-i18n="subir_juego">Subir Juego</span></a>
            </div>
            <div class="dropdown-group">
              <a href="biblioteca.html" class="menu-item"><i class="fas fa-book"></i><span data-i18n="biblioteca">Biblioteca</span></a>
              <a href="descarga.html" class="menu-item"><i class="fas fa-download"></i><span data-i18n="descargas">Descargas</span></a>
            </div>
            <hr class="divider">
            <div class="dropdown-group">
              <a href="configuracion.html" class="menu-item"><i class="fas fa-cog"></i><span data-i18n="configuracion">Configuración</span></a>
              <a href="perfil-editar.html" class="menu-item"><i class="fas fa-user-edit"></i><span data-i18n="editar_usuario">Editar Usuario</span></a>
              <a href="pagos-desarrollador.html" class="menu-item"><i class="fas fa-star"></i><span data-i18n="suscripcion">Suscripción</span></a>
              <a href="seguidos.html" class="menu-item"><i class="fas fa-heart"></i><span data-i18n="seguidos">Seguidos</span></a>
            </div>
            <hr class="divider">
            <div class="dropdown-group">
              <button class="menu-item logout"><i class="fas fa-sign-out-alt"></i><span data-i18n="cerrar_sesion">Cerrar Sesión</span></button>
            </div>
          </div>
        </div>
      </div>
    </div>
</nav>

<header class="community-header">
  <h1>Comunidad de Desarrolladores - TakumiNet</h1>
  <p>¡Bienvenido a la comunidad! Comparte, aprende y conecta con otros desarrolladores.</p>
</header>

<section class="foro-rules-box">
  <button id="toggle-rules" class="toggle-rules-btn">
    Mostrar reglas para crear un foro
  </button>
  <div id="rules-content" class="foro-rules-content" style="display: none;">
    <ul class="foro-rules-list">
      <li><strong>Sé claro y específico:</strong> Usa un título que resuma el tema de forma directa.</li>
      <li><strong>Evita el spam:</strong> No publiques enlaces irrelevantes o contenido promocional.</li>
      <li><strong>Categoriza correctamente:</strong> Selecciona la categoría que mejor se ajuste al tema.</li>
      <li><strong>Respeta a los demás:</strong> No se toleran insultos, lenguaje ofensivo o contenido discriminatorio.</li>
      <li><strong>Comparte con valor:</strong> Intenta que tu descripción aporte algo útil a la comunidad.</li>
      <li><strong>Usa etiquetas:</strong> Añade etiquetas clave para facilitar la búsqueda de tu tema.</li>
      <li><strong>No repitas temas:</strong> Antes de crear, revisa si ya existe un foro similar.</li>
    </ul>
    <p class="foro-rules-footer">
      Cumplir estas reglas ayuda a mantener un espacio sano y útil para todos.
    </p>
  </div>
</section>

<section class="forum-section">
  <h2>Foros de Discusión</h2>
  <a href="crear-foro.html" class="promo-btn">Crear nuevo tema</a>
  <div class="forum-topic-container" id="forum-container">
    <!-- Foros cargados dinámicamente -->
  </div>
</section>


<script src="../js/notificacion.js"></script>
<script src="../js/carrito.js"></script>
<script src="../js/user.js"></script>
<script src="../js/desplegar.js"></script>
<script src="../js/cerrar sesion.js"></script>
<script src="../js/comunidad.js"></script>
<script src="../js/usario.js"></script>
<script src="../autoSync.js"></script>
<script src="../script.js"></script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const forumContainer = document.getElementById('forum-container');

  fetch('http://localhost:3001/foros')
    .then(async response => {
      if (!response.ok) {
        const errorText = await response.text();
        throw new Error(`HTTP error! status: ${response.status} - ${errorText}`);
      }
      return response.json();
    })
    .then(foros => {
      forumContainer.innerHTML = '';

      if (!Array.isArray(foros)) {
        forumContainer.innerHTML = '<p>Formato de datos inesperado.</p>';
        return;
      }

      if (foros.length === 0) {
        forumContainer.innerHTML = '<p>No hay foros disponibles.</p>';
        return;
      }

      foros.forEach(foro => {
        const foroCard = document.createElement('div');
        foroCard.classList.add('topic-card');  // Usa tu clase CSS existente

        // Link con query string para identificar el foro
        // Usa encodeURIComponent para evitar problemas con caracteres especiales
        const foroUrl = `chat comunidad.html?id=${encodeURIComponent(foro.id)}`;

        foroCard.innerHTML = `
          <div class="topic-header">
            <div class="topic-image-container">
              <img src="${foro.image_base64 || 'default-image.jpg'}" alt="${foro.title}" class="topic-image">
            </div>
            <div class="topic-info">
              <h3><a href="${foroUrl}" class="foro-link">${foro.title}</a></h3>
              <div class="topic-meta">
                <span><strong>Categoría:</strong> ${foro.category}</span>
              </div>
            </div>
          </div>
          <div class="topic-content">
            <p>${foro.description}</p>
            <div class="topic-tags">
              ${foro.tags ? foro.tags.split(',').map(tag => `<span class="tag">${tag.trim()}</span>`).join('') : ''}
            </div>
          </div>
          <div class="topic-footer">
            <button class="btn-view-topic" data-id="${foro.id}">Ir al chat</button>
          </div>
        `;

        // Evento click para botón que redirige al chat con el ID del foro
        foroCard.querySelector('.btn-view-topic').addEventListener('click', () => {
          window.location.href = foroUrl;
        });

        forumContainer.appendChild(foroCard);
      });
    })
    .catch(error => {
      console.error('Error en fetch:', error);
      forumContainer.innerHTML = '<p>Error al cargar los foros.</p>';
    });
}); 
</script>


</body>
</html>

